{% extends "base.html" %}
{% block title %}Add a Node - Sub Search{% endblock %}

{% block content %}
<!-- Header -->
<div class="card mb-4">
  <div class="card-body p-4">
    <p class="stat-label mb-2">Join the Network</p>
    <h1 class="h2 mb-3">Volunteer Your Machine</h1>
    <p class="text-muted mb-4" style="max-width: 700px;">
      Share your computer + Reddit account to help grow the subreddit database. We'll email you a private management link - no login needed.
    </p>

    <div class="row g-3">
      <div class="col-sm-4">
        <div class="bg-input rounded p-3">
          <div class="d-flex align-items-center gap-2 text-success">
            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span class="small fw-medium">Reddit API access required</span>
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <div class="bg-input rounded p-3">
          <div class="d-flex align-items-center gap-2 text-success">
            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span class="small fw-medium">Cloud & homelab friendly</span>
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <div class="bg-input rounded p-3">
          <div class="d-flex align-items-center gap-2 text-success">
            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span class="small fw-medium">Auto-cleanup after 7 days</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Form -->
<div class="card">
  <div class="card-body">
    <form method="post">
      {% csrf_token %}
      <div class="row g-4">
        <!-- Left Column -->
        <div class="col-lg-6">
          <div class="mb-3">
            <label for="email" class="form-label">Contact Email <span class="text-danger">*</span></label>
            <input type="email" class="form-control" id="email" name="email" required value="{{ form_data.email }}" placeholder="you@example.com">
            <div class="form-text">We'll send your private management link here</div>
          </div>
          <div class="mb-3">
            <label for="reddit_username" class="form-label">Reddit Username <span class="text-danger">*</span></label>
            <input type="text" class="form-control" id="reddit_username" name="reddit_username" required value="{{ form_data.reddit_username }}" placeholder="u/yourname">
            <div class="form-text">Must have Reddit API access configured</div>
          </div>
          <div class="mb-3">
            <label for="location" class="form-label">Location / Timezone</label>
            <input type="text" class="form-control" id="location" name="location" value="{{ form_data.location }}" placeholder="e.g. Portland, OR (UTC-7)">
          </div>
          <div class="mb-3 mb-lg-0">
            <label for="availability" class="form-label">Availability</label>
            <input type="text" class="form-control" id="availability" name="availability" value="{{ form_data.availability }}" placeholder="e.g. Weeknights, 7pm-midnight">
          </div>
        </div>

        <!-- Right Column -->
        <div class="col-lg-6">
          <div class="mb-3">
            <label for="system_details" class="form-label">Hardware Details</label>
            <textarea class="form-control" id="system_details" name="system_details" rows="3" placeholder="CPU, RAM, connection details...">{{ form_data.system_details }}</textarea>
          </div>
          <div class="mb-3">
            <label for="bandwidth_notes" class="form-label">Bandwidth</label>
            <input type="text" class="form-control" id="bandwidth_notes" name="bandwidth_notes" value="{{ form_data.bandwidth_notes }}" placeholder="e.g. 500 Mbps fiber, metered weekends">
          </div>
          <div class="mb-3 mb-lg-0">
            <label for="notes" class="form-label">Notes / Public Bio</label>
            <textarea class="form-control" id="notes" name="notes" rows="3" placeholder="Anything you'd like to share publicly...">{{ form_data.notes }}</textarea>
            <div class="form-text">Shown on the public nodes list</div>
          </div>
        </div>

        <!-- Submit -->
        <div class="col-12">
          <button type="submit" class="btn btn-primary w-100 py-3">
            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
            </svg>
            Submit Node
          </button>
        </div>
      </div>
    </form>
  </div>
</div>

{% if manage_link %}
<!-- Success Message -->
<div class="card mt-4" style="border-color: rgba(70, 209, 96, 0.3);">
  <div class="card-body">
    <div class="d-flex align-items-start gap-3">
      <div class="rounded-circle d-flex align-items-center justify-content-center flex-shrink-0" style="width: 40px; height: 40px; background-color: rgba(70, 209, 96, 0.2);">
        <svg width="24" height="24" class="text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
      </div>
      <div class="flex-grow-1">
        <h5 class="text-success mb-1">Node Registered!</h5>
        <p class="small text-muted mb-3">Bookmark this link - it lets you update or delete your node without logging in:</p>
        <a href="{{ manage_link }}" class="d-inline-block px-3 py-2 rounded small" style="background-color: var(--ss-bg-input); border: 1px solid var(--ss-border); word-break: break-all;">
          {{ manage_link }}
        </a>
        {% if not email_sent %}
        <p class="mt-3 mb-0 small text-danger">
          <svg width="16" height="16" class="me-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
          </svg>
          Email delivery is disabled. Save this link now!
        </p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endif %}
{% endblock %}
